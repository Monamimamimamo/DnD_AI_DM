# üéÆ AI Dungeon Master

–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è –∑–∞–º–µ–Ω–∞ Dungeon Master –¥–ª—è –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–π —Ä–æ–ª–µ–≤–æ–π –∏–≥—Ä—ã D&D 5e —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é Mistral 7B.

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç AI-—Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∑–∞–º–µ–Ω–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ –≤ —Ä–æ–ª–∏ Dungeon Master, –≥–µ–Ω–µ—Ä–∏—Ä—É—è —Å—é–∂–µ—Ç—ã, —É–ø—Ä–∞–≤–ª—è—è NPC –∏ —Å–ª–µ–¥—è –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª D&D. **–†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ API –∫–ª—é—á–µ–π!**

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
  - **DM Agent** - –Ω–∞—Ä—Ä–∞—Ç–∏–≤ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ (LLM, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Mistral 7B)
  - **Rule Engine** - –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª D&D 5e —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö SRD**
  - **Action Parser** - –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ª—é–±—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–∞ (LLM, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Phi-3 Mini –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ JSON)
- **–õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ API –∫–ª—é—á–µ–π
  - –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á (—Ç–≤–æ—Ä—á–µ—Å–∫–∞—è –¥–ª—è DM, –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞)
- **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ D&D 5e** - –≤—Å–µ –∫–ª–∞—Å—Å—ã, —Ä–∞—Å—ã, –Ω–∞–≤—ã–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—é–∂–µ—Ç–æ–≤** - –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã** - –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –ø–æ–∑–∂–µ
- **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –Ω–∏–∫–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

1. **–†–µ–∂–∏–º –∏—Å—Ç–æ—Ä–∏–∏** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—é–∂–µ—Ç–∞, –¥–∏–∞–ª–æ–≥–∏, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
2. **–†–µ–∂–∏–º –±–æ—è** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–µ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞–º–∏ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama
```bash
curl -fsSL https://ollama.ai/install.sh | sh
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á:

**–î–ª—è DM Agent (–Ω–∞—Ä—Ä–∞—Ç–∏–≤, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ):**
```bash
ollama pull mistral:7b
```

**–î–ª—è Action Parser (–ø–∞—Ä—Å–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π –≤ JSON, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
ollama pull llama3.1:8b  # –õ—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ JSON –∏ –ø—Ä–∞–≤–∏–ª D&D
# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
# ollama pull phi3:mini  # –ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–∞—è
# ollama pull llama3.2:3b  # –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
# ollama pull qwen2.5:7b
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ `llama3.1:8b` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `mistral:7b`, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ.

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 4. –ó–∞–ø—É—Å–∫ 5e-srd-api (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª–Ω—ã–º –¥–∞–Ω–Ω—ã–º SRD —á–µ—Ä–µ–∑ REST API:

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π API (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω)
cd /home/kirill/StudioProjects
git clone https://github.com/5e-bits/5e-srd-api.git

# –ó–∞–ø—É—Å–∫–∞–µ–º API
cd 5e-srd-api
docker compose up -d
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000/api/2014`

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [API_SETUP.md](API_SETUP.md)

### 5. –î–∞–Ω–Ω—ã–µ SRD

–î–∞–Ω–Ω—ã–µ SRD –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ API:
- –ù–∞–≤—ã–∫–∏ –∏ –¥–µ–π—Å—Ç–≤–∏—è
- –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è, –∫–ª–∞—Å—Å—ã, —Ä–∞—Å—ã (–≤–µ—Ä—Å–∏—è 2014)
- –ú–æ–Ω—Å—Ç—Ä—ã –∏ –ø—Ä–µ–¥–º–µ—Ç—ã

–î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ `~/.dnd_ai_dm/srd_cache/{version}/` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ `~/.dnd_ai_dm/srd_cache/`, –∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏–∏ 2014 –∏ 2024. –í–µ—Ä—Å–∏—è 2014 –∏–º–µ–µ—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤—Å–µ—Ö endpoints. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [VERSIONS.md](VERSIONS.md)

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
```bash
python3 simple_dm_demo.py
```

### –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
```bash
python3 src/main.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ ai_engine/          # AI –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ dungeon_master.py      # –ì–ª–∞–≤–Ω—ã–π AI DM
‚îÇ   ‚îú‚îÄ‚îÄ orchestrator.py        # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ local_llm_client.py   # –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ game_rules/         # –ü—Ä–∞–≤–∏–ª–∞ D&D 5e (–Ω–æ–≤—ã–π –º–æ–¥—É–ª—å)
‚îÇ   ‚îú‚îÄ‚îÄ rule_engine.py         # –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Rule Engine (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç SRD)
‚îÇ   ‚îú‚îÄ‚îÄ action_parser.py       # LLM-–ø–∞—Ä—Å–µ—Ä –¥–µ–π—Å—Ç–≤–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ dice.py                # –£—Ç–∏–ª–∏—Ç–∞ –±—Ä–æ—Å–∫–æ–≤ –∫—É–±–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ srd_data.py            # –ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö SRD
‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ game_state/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ character.py           # –ö–ª–∞—Å—Å—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ game_manager.py       # –ú–µ–Ω–µ–¥–∂–µ—Ä –∏–≥—Ä—ã
‚îî‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–º. –≤ [ARCHITECTURE.md](ARCHITECTURE.md)

**–ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è:**
1. –ò–≥—Ä–æ–∫ ‚Üí **Action Parser** (LLM) ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
2. ‚Üí **Rule Engine** (–¥–µ—Ç–µ—Ä–º.) ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª
3. ‚Üí **DM Agent** (LLM) ‚Üí –Ω–∞—Ä—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏–≥—Ä–µ –≤ D&D —Å AI Dungeon Master'–æ–º!
